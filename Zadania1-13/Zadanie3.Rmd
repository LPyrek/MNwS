---
title: "Zadanie3"
author: "ukasz Pyrek"
date: "2023-05-03"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(cache = TRUE)
```
Za pomoc odpowiednich symulacji zbada moc testu Komogorowa-Smirnowa w przypadku, gdy
rozwa偶ane pr贸bki danych pochodz w rozkad贸w 
2 o r贸偶nej liczbie stopni swobody. Do cel贸w
symulacji prosz przesun generowane dane tak, by miay t sam warto oczekiwan. Uzyskane
wyniki nale偶y przedstawi na odpowiednich wykresach ilustrujcych moce test贸w z uwzgldnieniem: <br />
- liczby danych (mo偶na rozwa偶a r贸偶ne liczebnoci w ka偶dej z pr贸bek),<br />
- liczby stopni swobody. <br />
```{r}
library(ggplot2)
power_fun <- function(n, df1, df2){
  mean(
    sapply(1:1000, function(i) {
      sample1 = (rchisq(n, df1) - df1)/sqrt(2*df1)
      sample2 = (rchisq(n, df2) - df2)/sqrt(2*df2)
      ks.test(sample1,sample2)$p.val < 0.05
    })
  )
}
df1_seq = c(3,5,10,25,50)
df2_seq = c(3,5,10,25,50,100)
n_seq = c(seq(5,100,5),seq(125,300,25))

for(df1 in df1_seq){
  data_list <- NULL
  data <- NULL
  data_list <-
    lapply(n_seq, function(n){
      data.frame(
        n = n,
        df = df2_seq,
        power = sapply(df2_seq, function(df2) power_fun(n, df1, df2))
      )  
    })
  data <- do.call(rbind, data_list)
  plot <- ggplot(data = data, aes(x=n,y=power, col = factor(df))) +
    geom_line() + 
    geom_hline(yintercept=0.05, linetype='dotted') + 
    geom_hline(yintercept=1, linetype='dotted') +
    ggtitle(paste("liczba stopni swobody pierwszego rozkadu:",df1)) + labs(col = "Stopnie swobody drugiego rozkadu")
  print(plot)
}

```
