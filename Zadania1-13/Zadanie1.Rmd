---
title: "Zadanie1"
author: "ukasz Pyrek"
date: "2023-05-01"
output:
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(cache = TRUE)
```
Za pomoc odpowiednich symulacji por贸wna moce testu Shapiro-Wilka, testu Komogorowa i testu 2
(z hipotez g贸wn, 偶e cecha ma rozkad normalny) w przypadku, gdy dane pochodz z rozkadu
-Studenta lub innej klasy rozkad贸w symetrycznych (uwaga: 偶eby wyniki byy por贸wnywalne trzeba
pamita o standaryzacji danych). Uzyskane wyniki nale偶y przedstawi na odpowiednich wykresach
ilustrujcych moce test贸w z uwzgldnieniem: <br />
- liczby danych, <br />
- liczby stopni swobody generowanego rozkadu t-Studenta lub innych parametr贸w wybranego rozkadu.
```{r}
library(DescTools)
library(ggplot2)

power_fun <- function(test, n, df){

  if(toString(test) == 'ks.test'){
    result <- mean(
                sapply(1:10000, function(i){
                  sample <- rt(n,df)
                  sample <- (sample - mean(sample))/sd(sample)
                  ks.test(sample,'pnorm')$p.value < 0.05}))
    return(result)
  }
  fun_test <- match.fun(test)
  mean(
    sapply(1:10000, function(i) {
      sample <- rt(n,df)
      sample <- (sample - mean(sample))/sd(sample)
      fun_test(sample)$p.val < 0.05
    })
  )
}

n_seq = c(seq(5,100,5),seq(125,300,25))
df_seq = c(5,10,30)

for(test in c('shapiro.test','PearsonTest','ks.test')){
  data_list <- NULL
  data <- NULL
  data_list <-
    lapply(n_seq, function(n){
      data.frame(
        n = n,
        df = df_seq,
        power = sapply(df_seq, function(df) power_fun(test, n, df))
      )  
    })
  data <- do.call(rbind, data_list)
  plot <- ggplot(data = data, aes(x=n,y=power, col = factor(df))) +
    geom_line() + 
    geom_hline(yintercept=0.05, linetype='dotted') + 
    geom_hline(yintercept=1, linetype='dotted') +
    ggtitle(test) + labs(col = "Stopnie swobody")
  print(plot)
}

```
<br />
Jak wida test shapiro-wilka ma najwieksz moc testu.
Mozna r贸wnie偶 zauwa偶y 偶e wraz ze wzrostem  liczebnoci pr贸by wzrasta moc testu, <br />
oraz 偶e wraz ze wzrostem liczby stopni swobody moc testu spada, <br />
co ma sens gdy偶 wraz ze wzrostem liczby swobody rozkad t-studenta co raz bardziej <br />
przypomina rozkad normalny przez co testowi trudniej wykry r贸znice.
